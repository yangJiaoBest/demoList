<%@ page language="java" pageEncoding="UTF-8" contentType="text/html;charset=utf-8"%><%@ include file="/common/taglibs.jsp"%><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html>	<head>		<meta http-equiv="X-UA-Compatible" content="IE=100" />		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />		<% String path = request.getContextPath();%>		<%@ include file="/common/metas.jsp"%>		<link rel="stylesheet" type="text/css" href="<c:url value=" /styles/portal.style.css "/>" />		<script language="javascript" type="text/javascript" src="<c:url value='/scripts/jquery.cookie.js'/>"></script>		<style type="text/css">			input[type=text],input[type=password] {				width: 150px;			}		</style>		<script type="text/javascript" charset="UTF-8">						$(function() {				//原密码 失去焦点做判断				$('#userPwd').on('blur', function() {					checkPayPassword($(this));				});				//新密码 失去焦点做判断				$('#newUserPwd').on('blur', function() {					checkPayPassword($(this));				});				//新密码确认 失去焦点做判断				$('#newUserPwd1').on('blur', function() {					checkPayPassword($(this));				});				//表单提交 校验				$('#modifyPasswordForm').submit(function() {					$('#modifyPasswordForm input[type=password]').each(function() {						if($(this).val() == '') {							$(this).addClass('on');							$(this).siblings('i').show();							$(this).siblings('i').text("密码不能为空");						}					});					checkPayPassword($(this));					var canSumbit = true;					var userPwd = $("#userPwd").hasClass('on');					var newUserPwd = $("#newUserPwd").hasClass('on');					var newUserPwd1 = $("#newUserPwd1").hasClass('on');					if(userPwd && newUserPwd && newUserPwd1 && canSumbit) {						canSubmit = false;						return false;					}				});				/*---------验证密码--------*/				function checkPayPassword(obj) {					var value = $.trim(obj.val());					//如果不输入密码，则边框变红					if(value == "") {						obj.addClass('on');						obj.siblings('i').show();						obj.siblings('i').text("密码不能为空");					} else {						//对原密码进行校验						if(obj.attr("id") == 'userPwd') {							//向后台发送请求，校验原密码是否正确							//http://localhost:8099/passwordModifier/pages/update/checkPassword.action?userName=00004633&userPwd=H@ppy123							var userName = $("#userName").val();							var userPwd = $("#userPwd").val();							$.ajax({								type:"post",								url:"http://10.1.83.176:8099/passwordModifier/pages/update/checkPassword.action",								data:{									userName:userName,									userPwd:userPwd								},								dataType:'jsonp',								jsonp:'callback',								jsonpCallback:'oldPassword',								success:function(data){									if(data.message == 'right'){										obj.siblings('i').hide();										obj.removeClass('on');									}else{										obj.addClass('on');										obj.siblings('i').show();										obj.siblings('i').text("原密码输入错误");									}								},								error:function(data){																	}							});						}						//对新密码进行校验						if(obj.attr("id") == 'newUserPwd') {							var regexpPwd = /^(?:(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])).{8,20}$/;							//必须包含大小写字母和数字							if(value.length < 8 || value.length > 20) {								obj.siblings('i').show();								obj.siblings('i').text("密码长度为8-20位");								obj.addClass('on');							} else if(value == $("#userPwd").val()){								obj.siblings('i').show();								obj.siblings('i').text("密码不能与原密码相同");								obj.addClass('on');							}else if(!regexpPwd.test(value)){								obj.siblings('i').show();								obj.siblings('i').text("密码必须包含大写字母、小写字母、数字");								obj.addClass('on');							}else if(!value.indexOf($("#userName").val()) == -1) {								obj.siblings('i').show();								obj.siblings('i').text("密码口令中不能包含工号");								obj.addClass('on');							} else {								obj.siblings('i').hide();								obj.removeClass('on');							}						}						//对新密码确认 进行校验						if(obj.attr("id") == 'newUserPwd1') {							var val = $.trim($("#newUserPwd").val());							if(value != val) {								obj.siblings('i').show();								obj.siblings('i').text("两次密码输入不一致");								obj.addClass('on');							} else {								obj.siblings('i').hide();								obj.removeClass('on');							}						}					}				}			})		</script>	</head>	<body>		<div class="ind_tads_con_wrapper" />		<div class="ind_tags_con_body clearfix" />		<div id="containerPass">		<!--如果校验全部通过，则成功-->		 <c:if test="${'success' == modifyResult}">			<script type="text/javascript">				alert("密码修改成功！");				window.location.href='portal.boe.com.cn/wps/myportal/Home/home/!ut/p/z1/04_Sj9CPykssy0xPLMnMz0vMAfIjo8zizQwMnD0sTIx83Y2CnQ0cjUPCDIyNvY0MDAz0wwkpiAJKG-AAjiD9UViUOBo4BRk5GRsYuPsbYVWAYkZBboRBpqOiIgBq7zMq/dz/d5/L3dJVkNwQSEhL0lCakFBQXlBQkVRaUlBISEvNE5sRkNvWTRWSEZnSkEhIS9aNl82MDBDSDg0Mk1HMlNDMEEzVFYwMzNLMjAwMC9LNER1TTVhNE15V3Bfdmx1eFFtSWVNTTpiSTVlZDVwY2RUajVOYU9JenZDU1YzZ3p3LzIwMjkyNi9sbw!!/';			</script>		</c:if>			<form name="modifyPasswordForm" id="modifyPasswordForm" action="/passwordModifier/modifyPassword.action" method="post" >				<table width="100%" cellspacing="20" cellpadding="0" >					<tr>						<td  ><label for="bizCode">用户名（登录名）：</label></td>						<!--<td ><input type="hidden" name="userName" id="userName" value="<%=request.getRemoteUser() %>" readonly />							<%=request.getRemoteUser() %>						</td>-->						<td ><input type="hidden" name="userName" id="userName" value="00004633" readonly="readonly" />00004633</td>					</tr>					<tr>						<td ><label for="bizCode">原密码：</label></td>						<td ><input type="password" name="userPwd" id="userPwd" /><i class='oldPwd'>原密码输入错误</i></td>					</tr>					<tr>						<td ><label for="bizCode">新密码：</label></td>						<td><input type="password" name="newUserPwd" id="newUserPwd" /><i class='newPwd'>密码长度最少8位</i></td>					</tr>					<tr>						<td ><label for="bizCode">新密码确认：</label></td>						<td><input type="password" name="newUserPwd1" id="newUserPwd1"/><i class='newPwdCon'>两次录入密码不一致，请检查</i></td>					</tr>					<tr>						<td >&nbsp;</td>						<td ><input type="submit" value="确认修改" name="modify" id="modify" class="lsb" /></td>					</tr>					<tr>						<td >密码修改规则：</td>						<td >							<span>密码长度最少8位；</span> 							<span>密码必须包括大小写字母、小写字母、数字；</span>							<span>密码口令中不能包含工号；</span>							<span>密码使用时长180天，过期需要修改密码。</span>						</td>					</tr>				</table>			</form>		</div>	</body></html>